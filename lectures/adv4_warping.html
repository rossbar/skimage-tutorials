
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Warping images &#8212; scikit-image Tutorials</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Diatom analysis" href="adv5_pores.html" />
    <link rel="prev" title="scikit-image advanced panorama tutorial" href="adv3_panorama-stitching.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/skimage-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">scikit-image Tutorials</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../introduction.html">
   An introduction to scikit-image
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="00_images_are_arrays.html">
     Images are numpy arrays
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="1_image_filters.html">
     Image filtering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="3_morphological_operations.html">
     Morphological operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_segmentation.html">
     Segmentation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_tophat_filters.html">
     Correcting brightness nonuniformity with tophat filters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="6_watershed_tricks.html">
     Useful segmentation tricks with the watershed transform
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="three_dimensional_image_processing.html">
     Introduction to three-dimensional image processing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../applications.html">
   scikit-image applications
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="adv0_chromosomes.html">
     Measuring chromatin fluorescence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adv1_lesion-quantification.html">
     Quantifying spinal cord regeneration in zebrafish
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adv2_microarray.html">
     DNA microarray processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adv3_panorama-stitching.html">
     scikit-image advanced panorama tutorial
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Warping images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="adv5_pores.html">
     Diatom analysis
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/lectures/adv4_warping.md.txt"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#image-rotation-from-scratch">
   Image rotation from scratch
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-problematic-approach">
     A problematic approach
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#and-while-we-can-attempt-to-fix-the-problem">
     And while we can attempt to fix the problem…
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#for-later-discussion-interpolation">
   For later discussion: interpolation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bi-linear-interpolation">
     Bi-linear interpolation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-warping-experiments">
   Some warping experiments!
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fish-eye">
     Fish-eye
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-the-following-scripts-for-fun">
     Run the following scripts for fun:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#here-s-code-for-a-swirl-transform">
     Here’s code for a swirl transform:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#can-you-come-up-with-an-even-better-distortion">
   Can you come up with an even better distortion?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#start-with-this-template">
     Start with this template:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#composing-transformations">
     Composing Transformations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advanced-challenge-rectifying-an-image">
   Advanced challenge: rectifying an image
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#here-s-a-template-solution">
     Here’s a template solution:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#for-more-fun-examples-see-http-scikit-image-org-docs-dev-auto-examples">
   For more fun examples see http://scikit-image.org/docs/dev/auto_examples
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Warping images</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#image-rotation-from-scratch">
   Image rotation from scratch
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-problematic-approach">
     A problematic approach
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#and-while-we-can-attempt-to-fix-the-problem">
     And while we can attempt to fix the problem…
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#for-later-discussion-interpolation">
   For later discussion: interpolation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bi-linear-interpolation">
     Bi-linear interpolation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#some-warping-experiments">
   Some warping experiments!
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fish-eye">
     Fish-eye
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-the-following-scripts-for-fun">
     Run the following scripts for fun:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#here-s-code-for-a-swirl-transform">
     Here’s code for a swirl transform:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#can-you-come-up-with-an-even-better-distortion">
   Can you come up with an even better distortion?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#start-with-this-template">
     Start with this template:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#composing-transformations">
     Composing Transformations
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advanced-challenge-rectifying-an-image">
   Advanced challenge: rectifying an image
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#here-s-a-template-solution">
     Here’s a template solution:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#for-more-fun-examples-see-http-scikit-image-org-docs-dev-auto-examples">
   For more fun examples see http://scikit-image.org/docs/dev/auto_examples
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="warping-images">
<h1>Warping images<a class="headerlink" href="#warping-images" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>http://scikit-image.org/docs/stable/api/skimage.transform.html</p></li>
<li><p>http://scikit-image.org/docs/stable/api/skimage.transform.html#skimage.transform.warp</p></li>
<li><p>http://scikit-image.org/docs/stable/api/skimage.transform.html#skimage.transform.AffineTransform (and other similar classes)</p></li>
</ul>
</div>
<div class="section" id="image-rotation-from-scratch">
<h2>Image rotation from scratch<a class="headerlink" href="#image-rotation-from-scratch" title="Permalink to this headline">¶</a></h2>
<p>The following code shows how to rotate an image using the skimage (scikit-image) library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">transform</span><span class="p">,</span> <span class="n">data</span>

<span class="n">camera</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
<span class="n">rotated</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adv4_warping_3_0.png" src="../_images/adv4_warping_3_0.png" />
</div>
</div>
<p><span style="font-size: 150%;"><strong>Exercise:</strong> Write an algorithm from scratch that will
do the same (i.e., take an input image as an ndarray, and rotate it).</span></p>
<p>If you feel creative, you can also write code to magnify (zoom) the image.</p>
<p></p>
You may need: http://en.wikipedia.org/wiki/Polar_coordinate_system
<p></p>
A (bad) solution is given below--but try it yourself before looking!<div class="section" id="a-problematic-approach">
<h3>A problematic approach<a class="headerlink" href="#a-problematic-approach" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">color</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    
    <span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
    
    <span class="n">centre_x</span><span class="p">,</span> <span class="n">centre_y</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">height</span> <span class="o">/</span> <span class="mf">2.</span>
    
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
            
            <span class="n">x_c</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">centre_x</span>
            <span class="n">y_c</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">centre_y</span>
            
            <span class="c1"># Determine polar coordinate of pixel</span>
            <span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_c</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y_c</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">angle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y_c</span><span class="p">,</span> <span class="n">x_c</span><span class="p">)</span>
            
            <span class="n">new_angle</span> <span class="o">=</span> <span class="n">angle</span> <span class="o">+</span> <span class="n">theta</span>
            
            <span class="n">new_x</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">new_angle</span><span class="p">)</span>
            <span class="n">new_y</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">new_angle</span><span class="p">)</span>
            
            <span class="n">new_x</span> <span class="o">=</span> <span class="n">new_x</span> <span class="o">+</span> <span class="n">centre_x</span>
            <span class="n">new_y</span> <span class="o">=</span> <span class="n">new_y</span> <span class="o">+</span> <span class="n">centre_y</span>
            
            <span class="k">if</span> <span class="p">(</span><span class="n">new_x</span> <span class="o">&gt;=</span> <span class="n">width</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">new_x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span>\
               <span class="p">(</span><span class="n">new_y</span> <span class="o">&gt;=</span> <span class="n">height</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">new_y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">new_y</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_x</span><span class="p">)]</span> <span class="o">=</span> <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">out</span>

<span class="n">rotated</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rotated</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adv4_warping_7_0.png" src="../_images/adv4_warping_7_0.png" />
</div>
</div>
</div>
<div class="section" id="and-while-we-can-attempt-to-fix-the-problem">
<h3>And while we can attempt to fix the problem…<a class="headerlink" href="#and-while-we-can-attempt-to-fix-the-problem" title="Permalink to this headline">¶</a></h3>
<p>…this is not an optimal approach</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Attempt at fixing the holes using a median filter</span>
<span class="c1"># -- it works, sort of, but it&#39;s not the best approach.</span>

<span class="n">height</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">rotated</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">rotated</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">height</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">out</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">out</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">([</span><span class="n">out</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="n">out</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="n">out</span><span class="p">[</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span>
                                   <span class="n">out</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">]])</span>
            
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adv4_warping_9_0.png" src="../_images/adv4_warping_9_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[4 2]
 [1 6]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adv4_warping_11_0.png" src="../_images/adv4_warping_11_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="for-later-discussion-interpolation">
<h2>For later discussion: interpolation<a class="headerlink" href="#for-later-discussion-interpolation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bi-linear-interpolation">
<h3>Bi-linear interpolation<a class="headerlink" href="#bi-linear-interpolation" title="Permalink to this headline">¶</a></h3>
<img src="Bilinear_interpolation.png" style="float: left;"/>
<div style="clear: both;"/>
<p>Also see <a class="reference external" href="http://en.wikipedia.org/wiki/Bilinear_interpolation">bilinear interpolation on Wikipedia</a></p>
</div>
</div>
<div class="section" id="some-warping-experiments">
<h2>Some warping experiments!<a class="headerlink" href="#some-warping-experiments" title="Permalink to this headline">¶</a></h2>
<div class="section" id="fish-eye">
<h3>Fish-eye<a class="headerlink" href="#fish-eye" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">transform</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">io</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Load face</span>
<span class="n">face</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../images/stefan.jpg&#39;</span><span class="p">)</span>

<span class="c1"># Get the eye nicely in the middle</span>
<span class="n">face</span> <span class="o">=</span> <span class="n">face</span><span class="p">[:</span><span class="mi">185</span><span class="p">,</span> <span class="mi">15</span><span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">2.</span><span class="p">],</span> <span class="s1">&#39;or&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;image&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adv4_warping_15_0.png" src="../_images/adv4_warping_15_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define a transformation on the x-y coordinates</span>

<span class="k">def</span> <span class="nf">fisheye</span><span class="p">(</span><span class="n">xy</span><span class="p">):</span>
    <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">xc</span><span class="p">,</span> <span class="n">yc</span> <span class="o">=</span> <span class="p">(</span><span class="n">xy</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># Polar coordinates</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xc</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">yc</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">yc</span><span class="p">,</span> <span class="n">xc</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">r</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">2.1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1.8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)))</span> <span class="o">+</span> <span class="n">center</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Warp and display</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">warp</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">fisheye</span><span class="p">)</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Knock! Knock!&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adv4_warping_17_0.png" src="../_images/adv4_warping_17_0.png" />
</div>
</div>
</div>
<div class="section" id="run-the-following-scripts-for-fun">
<h3>Run the following scripts for fun:<a class="headerlink" href="#run-the-following-scripts-for-fun" title="Permalink to this headline">¶</a></h3>
<p>(Open up the terminal in the “scripts” directory first)</p>
<ul>
<li><p><strong>deswirl.py</strong> (run using: <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">deswirl.py</span></code>)</p>
<p>In the UK, a criminal tried to hide his identity by posting
swirled pictures of his face online.  Here, we use the
Mona Lisa to illustrate what he did.  Can you restore
her face back to normal? (Note that you can adjust the
position of the red dot, as well as move the sliders.)</p>
</li>
<li><p><strong>clock_deblur.py</strong></p>
<p>I took a picture of a wall clock while moving the camera.  Or perhaps the clock moved.
Either way, now I cannot read the time!  I’ve implemented a deblurring
algorithm–can you adjust its parameters to help me pin-point
the time?</p>
</li>
</ul>
</div>
<div class="section" id="here-s-code-for-a-swirl-transform">
<h3>Here’s code for a swirl transform:<a class="headerlink" href="#here-s-code-for-a-swirl-transform" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">transform</span>

<span class="k">def</span> <span class="nf">swirl</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">strength</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the coordinate mapping for a swirl transformation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span><span class="o">.</span><span class="n">T</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">center</span>
    <span class="n">rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Ensure that the transformation decays to approximately 1/1000-th</span>
    <span class="c1"># within the specified radius.</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span> <span class="o">/</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">theta</span> <span class="o">=</span> <span class="n">rotation</span> <span class="o">+</span> <span class="n">strength</span> <span class="o">*</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">rho</span> <span class="o">/</span> <span class="n">radius</span><span class="p">)</span> <span class="o">+</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span>

    <span class="n">xy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="n">xy</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">xy</span>


<span class="n">h</span><span class="p">,</span> <span class="n">w</span> <span class="o">=</span> <span class="n">face</span><span class="o">.</span><span class="n">shape</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>

<span class="n">parameters</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;center&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">w</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">h</span><span class="o">/</span><span class="mf">2.</span><span class="p">],</span>
              <span class="s1">&#39;strength&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
              <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>
              <span class="s1">&#39;rotation&#39;</span><span class="p">:</span>  <span class="mi">0</span><span class="p">}</span>

<span class="n">out</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">warp</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">swirl</span><span class="p">,</span> <span class="n">parameters</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">face</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adv4_warping_21_0.png" src="../_images/adv4_warping_21_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="can-you-come-up-with-an-even-better-distortion">
<h2>Can you come up with an even better distortion?<a class="headerlink" href="#can-you-come-up-with-an-even-better-distortion" title="Permalink to this headline">¶</a></h2>
<div class="section" id="start-with-this-template">
<h3>Start with this template:<a class="headerlink" href="#start-with-this-template" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_warp</span><span class="p">(</span><span class="n">xy</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../images/stefan.jpg&#39;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">warp</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">my_warp</span><span class="p">)</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adv4_warping_23_0.png" src="../_images/adv4_warping_23_0.png" />
</div>
</div>
</div>
<div class="section" id="composing-transformations">
<h3>Composing Transformations<a class="headerlink" href="#composing-transformations" title="Permalink to this headline">¶</a></h3>
<p>scikit-image allows you to compose several transformations.  For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>

<span class="n">cat</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">chelsea</span><span class="p">()</span>
<span class="n">horizontal_shift</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">SimilarityTransform</span><span class="p">(</span><span class="n">translation</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">multiple_shifts</span> <span class="o">=</span> <span class="n">horizontal_shift</span> <span class="o">+</span> <span class="n">horizontal_shift</span> <span class="o">+</span> <span class="n">horizontal_shift</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">transform</span><span class="o">.</span><span class="n">warp</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="n">horizontal_shift</span><span class="o">.</span><span class="n">inverse</span><span class="p">))</span>    <span class="c1"># Note the inverse!</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">transform</span><span class="o">.</span><span class="n">warp</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="n">multiple_shifts</span><span class="o">.</span><span class="n">inverse</span><span class="p">));</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/adv4_warping_25_0.png" src="../_images/adv4_warping_25_0.png" />
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">transform</span></code> module allows us to rotate images.  The inner workings is something like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_rotate</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">angle</span><span class="p">):</span>
    <span class="n">rotation_tf</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">SimilarityTransform</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">transform</span><span class="o">.</span><span class="n">warp</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rotation_tf</span><span class="o">.</span><span class="n">inverse</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">my_rotate</span><span class="p">(</span><span class="n">cat</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f4b35d86b90&gt;
</pre></div>
</div>
<img alt="../_images/adv4_warping_27_1.png" src="../_images/adv4_warping_27_1.png" />
</div>
</div>
<p>Note that this rotates the cat around the origin (top-left).</p>
<p><strong>Can you modify <code class="docutils literal notranslate"><span class="pre">my_rotate</span></code> to rotate the image around the center?</strong></p>
<p><em>Hint:</em></p>
<ol class="simple">
<li><p>Shift the image (see above) so that the center of the image lies at (0, 0)</p></li>
<li><p>Rotate the image</p></li>
<li><p>Shift the image back—the opposite of what you did in step 1</p></li>
</ol>
<p>All of this can be achieved by composing transformations and calling <code class="docutils literal notranslate"><span class="pre">warp</span></code> once.</p>
</div>
</div>
<div class="section" id="advanced-challenge-rectifying-an-image">
<h2>Advanced challenge: rectifying an image<a class="headerlink" href="#advanced-challenge-rectifying-an-image" title="Permalink to this headline">¶</a></h2>
<img src="../images/chapel_floor.png" style="float: left;"/><p>We know the above tiles are laid out in a square–can you transform
the image so that the tiles are displayed as if you were viewing them from above?</p>
<p>The centre-points of the corner circles are, given as (row, column) coordinates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">72</span><span class="p">,</span> <span class="mi">129</span><span class="p">)</span> <span class="o">--</span> <span class="n">top</span> <span class="n">left</span>
<span class="p">(</span><span class="mi">76</span><span class="p">,</span> <span class="mi">302</span><span class="p">)</span> <span class="o">--</span> <span class="n">top</span> <span class="n">right</span>
<span class="p">(</span><span class="mi">185</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span> <span class="o">--</span> <span class="n">bottom</span> <span class="n">left</span>
<span class="p">(</span><span class="mi">193</span><span class="p">,</span> <span class="mi">326</span><span class="p">)</span> <span class="o">--</span> <span class="n">bottom</span> <span class="n">right</span>
</pre></div>
</div>
<p>Hint: there is a linear transformation matrix, <span class="math notranslate nohighlight">\(H\)</span>, such that</p>
<p><span class="math notranslate nohighlight">\(H \mathbf{x} = \mathbf{x}'\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> is the <em>homogeneous</em> coordinate in the original image and
<span class="math notranslate nohighlight">\(\mathbf{x}'\)</span> is the <em>homogeneous</em> coordinate in the rectified image (with <em>homogeneous</em>
we simply mean that we add an extra 1 at the end, e.g. (72, 129) becomes (72, 129, 1).
The values for <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> and their new values, <span class="math notranslate nohighlight">\(\mathbf{x}'\)</span>,
are therefore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">72</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="s1">&#39; = (0, 0, 1)</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">76</span><span class="p">,</span> <span class="mi">302</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="s1">&#39; = (0, 400, 1)</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">185</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">x</span><span class="s1">&#39; = (400, 0, 1)</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">193</span><span class="p">,</span> <span class="mi">326</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="n">x</span><span class="s1">&#39; = (400, 400, 1)</span>
</pre></div>
</div>
<p>(You can choose any output size you like–I chose <span class="math notranslate nohighlight">\(400 \times 400\)</span>)</p>
<p>Why do we need homogeneous coordinates?  It allows us to have <em>translation</em> as part of H:</p>
<p><span class="math notranslate nohighlight">\(
\left[\begin{array}{ccc}
H_{00} &amp; H_{01} &amp; H_{02}\\
H_{10} &amp; H_{11} &amp; H_{12}\\
H_{20} &amp; H_{21} &amp; 1
\end{array}\right]\left[\begin{array}{c}
x\\
y\\
1
\end{array}\right]=\left[\begin{array}{c}
H_{00}x+H_{01}y+H_{02}\\
H_{10}x+H_{11}y+H_{12}\\
H_{20}x+H_{21}y+H_{22}
\end{array}\right]
\)</span></p>
<p>Note that each element of the output coordinate is of the form <span class="math notranslate nohighlight">\(ax + by + c\)</span>.  Without the 1 in the last position of the coordinate, there would have been no <span class="math notranslate nohighlight">\(+ c\)</span> and therefore no translation!</p>
<p>The question on how to determine <span class="math notranslate nohighlight">\(H\)</span> is left for another day.  If you are curious,
the <a class="reference download internal" download="" href="../_downloads/b4746d8f2d6a4f5e04144c58aeda34cd/homography.pdf"><code class="xref download docutils literal notranslate"><span class="pre">answer</span> <span class="pre">can</span> <span class="pre">be</span> <span class="pre">found</span> <span class="pre">here</span></code></a>.</p>
<p>In the meantime, I provide some code to calculate <span class="math notranslate nohighlight">\(H\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">skimage.transform</span> <span class="kn">import</span> <span class="n">estimate_transform</span>

<span class="n">source</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">129</span><span class="p">,</span> <span class="mi">72</span><span class="p">),</span>
                   <span class="p">(</span><span class="mi">302</span><span class="p">,</span> <span class="mi">76</span><span class="p">),</span>
                   <span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">185</span><span class="p">),</span>
                   <span class="p">(</span><span class="mi">326</span><span class="p">,</span> <span class="mi">193</span><span class="p">)])</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">400</span><span class="p">],</span>
                   <span class="p">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">]])</span>

<span class="n">tf</span> <span class="o">=</span> <span class="n">estimate_transform</span><span class="p">(</span><span class="s1">&#39;projective&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="n">H</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">params</span>
<span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 3.04026872e+00  1.04929628e+00 -4.67743998e+02]
 [-1.44134582e-01  6.23382067e+00 -4.30241727e+02]
 [ 2.63620672e-05  4.17694527e-03  1.00000000e+00]]
</pre></div>
</div>
</div>
</div>
<p>Using the code in the cell above, you can compute the target coordinate of any position in the original image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify that the top left corner maps to (0, 0)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">129</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">z</span> <span class="o">/=</span> <span class="n">z</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[4.35868737e-14]
 [1.30760621e-13]
 [1.00000000e+00]]
</pre></div>
</div>
</div>
</div>
<div class="section" id="here-s-a-template-solution">
<h3>Here’s a template solution:<a class="headerlink" href="#here-s-a-template-solution" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rectify</span><span class="p">(</span><span class="n">xy</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">xy</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># We need to provide the backward mapping, from the target</span>
    <span class="c1"># image to the source image.</span>
    <span class="n">HH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
    
    <span class="c1"># You must fill in your code here to take</span>
    <span class="c1"># the matrix HH (given above) and to transform</span>
    <span class="c1"># each coordinate to its new position.</span>
    <span class="c1"># </span>
    <span class="c1"># Hint: handy functions are</span>
    <span class="c1">#</span>
    <span class="c1"># - np.dot (matrix multiplication)</span>
    <span class="c1"># - np.ones_like (make an array of ones the same shape as another array)</span>
    <span class="c1"># - np.column_stack</span>
    <span class="c1"># - A.T -- type .T after a matrix to transpose it</span>
    <span class="c1"># - x.reshape -- reshapes the array x</span>
    
    <span class="c1"># ... your code</span>
    <span class="c1"># ... your code</span>
    <span class="c1"># ... your code</span>
    <span class="c1"># ... your code</span>
    
    <span class="k">return</span> <span class="o">...</span>

    
<span class="n">image</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;images/chapel_floor.png&#39;</span><span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">warp</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rectify</span><span class="p">,</span> <span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>

<span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ax0</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Input</span> <span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="c1"># You must fill in your code here to take</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="c1"># the matrix HH (given above) and to transform</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span>     <span class="c1"># each coordinate to its new position.</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">23</span>     <span class="c1"># ... your code</span>
<span class="g g-Whitespace">     </span><span class="mi">24</span>     <span class="c1"># ... your code</span>
<span class="g g-Whitespace">     </span><span class="mi">26</span>     <span class="k">return</span> <span class="o">...</span>
<span class="ne">---&gt; </span><span class="mi">29</span> <span class="n">image</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;images/chapel_floor.png&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">30</span> <span class="n">out</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">warp</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">rectify</span><span class="p">,</span> <span class="n">output_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span> <span class="mi">400</span><span class="p">))</span>
<span class="g g-Whitespace">     </span><span class="mi">32</span> <span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">ax0</span><span class="p">,</span> <span class="n">ax1</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="nn">File ~/.virtualenvs/skimage-tutorials/lib/python3.10/site-packages/matplotlib/pyplot.py:2139,</span> in <span class="ni">imread</span><span class="nt">(fname, format)</span>
<span class="g g-Whitespace">   </span><span class="mi">2137</span> <span class="nd">@_copy_docstring_and_deprecators</span><span class="p">(</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2138</span> <span class="k">def</span> <span class="nf">imread</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">2139</span>     <span class="k">return</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>

<span class="nn">File ~/.virtualenvs/skimage-tutorials/lib/python3.10/site-packages/matplotlib/image.py:1560,</span> in <span class="ni">imread</span><span class="nt">(fname, format)</span>
<span class="g g-Whitespace">   </span><span class="mi">1558</span>                 <span class="n">response</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="g g-Whitespace">   </span><span class="mi">1559</span>             <span class="k">return</span> <span class="n">imread</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">ext</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1560</span> <span class="k">with</span> <span class="n">img_open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">image</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1561</span>     <span class="k">return</span> <span class="p">(</span><span class="n">_pil_png_to_float_array</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1562</span>             <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">PIL</span><span class="o">.</span><span class="n">PngImagePlugin</span><span class="o">.</span><span class="n">PngImageFile</span><span class="p">)</span> <span class="k">else</span>
<span class="g g-Whitespace">   </span><span class="mi">1563</span>             <span class="n">pil_to_array</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>

<span class="nn">File ~/.virtualenvs/skimage-tutorials/lib/python3.10/site-packages/PIL/ImageFile.py:100,</span> in <span class="ni">ImageFile.__init__</span><span class="nt">(self, fp, filename)</span>
<span class="g g-Whitespace">     </span><span class="mi">96</span> <span class="bp">self</span><span class="o">.</span><span class="n">decodermaxblock</span> <span class="o">=</span> <span class="n">MAXBLOCK</span>
<span class="g g-Whitespace">     </span><span class="mi">98</span> <span class="k">if</span> <span class="n">isPath</span><span class="p">(</span><span class="n">fp</span><span class="p">):</span>
<span class="g g-Whitespace">     </span><span class="mi">99</span>     <span class="c1"># filename</span>
<span class="ne">--&gt; </span><span class="mi">100</span>     <span class="bp">self</span><span class="o">.</span><span class="n">fp</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">101</span>     <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">fp</span>
<span class="g g-Whitespace">    </span><span class="mi">102</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_exclusive_fp</span> <span class="o">=</span> <span class="kc">True</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;images/chapel_floor.png&#39;
</pre></div>
</div>
</div>
</div>
<div style="height: 100px;">&nbsp;</div>
<div>
The solution to the above problem is provided as [solutions/tile_rectify.py](solutions/tile_rectify.py).  Only look at it after you've attempted the problem yourself!
</div></div>
</div>
<div class="section" id="for-more-fun-examples-see-http-scikit-image-org-docs-dev-auto-examples">
<h2>For more fun examples see http://scikit-image.org/docs/dev/auto_examples<a class="headerlink" href="#for-more-fun-examples-see-http-scikit-image-org-docs-dev-auto-examples" title="Permalink to this headline">¶</a></h2>
</div>
</div>


              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="adv3_panorama-stitching.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">scikit-image advanced panorama tutorial</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="adv5_pores.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Diatom analysis</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By the scikit-image community<br/>
    
        &copy; Copyright 2021, the scikit-image community.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>